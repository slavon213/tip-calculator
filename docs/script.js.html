<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: script.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: script.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** 
 * Елемент форми
 * @type {HTMLFormElement} 
 * 
 */
const form = document.getElementById("form");

/**
 * Поле вводу суми чеку
 * @type {HTMLInputElement}
 */
const bill = document.getElementById("bill");

/**
 П поле вводу кастомнорго відсотка чайових
 * @type {HTMLInputElement}
 */
const customTip = document.getElementById("custom-tip");

/**
 * Поле вводу кількості людей
 * @type {HTMLInputElement}
 */
const numberOfPeople = document.getElementById("people-number");
/**
 * Кнопка очищення форми
 * @type {HTMLButtonElement}
 */
const resetButton = document.getElementById("resetButton");
/**
 * Список кнопок з стандартними значеннями відсотка чайових
 * @type {NodeListOf&lt;HTMLButtonElement>}
 */
const tipButtons = document.querySelectorAll(".tip-amount");
/**
 * Елемент для відображення відсотка  чайових на одну людину
 * @type {HTMLSpanElement}
 */
const displayTipPerPerson = document.querySelector("#tip-amount > span");
/**
 * Елемент для відображення відсотка  повної суми на одну людину
 * @type {HTMLSpanElement}
 */
const displayTotalPerPerson = document.querySelector("#total-bill > span");
/**
 * Список елементів для відображення помилки поля вводу
 * @type {NodeListOf&lt;HTMLElement>}
 */
const errors = document.querySelectorAll("small");


/**
 * Обробляє подію форми
 * @param {SubmitEvent} e
 */
form.addEventListener("submit", (e) => {
    e.preventDefault();
    process();
});


/**
 * Очищає форму та деактивує кнопку reset.
 */
resetButton.addEventListener("click", function () {
    clearForm();
    this.classList.add("disabled");
    this.disabled = true;
});

/**
 * Функція, яка виконує всі обчислення і показує результат на екрані.
 * 
 */
function process() {
    const billIsValid = validationNonZero(bill);
    const numberPeopleIsValid = validationNonZero(numberOfPeople);

    if (billIsValid &amp;&amp; numberPeopleIsValid) {
        resetButton.disabled = false;
        const [tipPerPerson, totalPerPerson] = calculate();
        showNumbers(tipPerPerson, totalPerPerson);
        resetButton.classList.remove("disabled");
    }
}

/**
 * Відображає розраховані значення на сторінці.
 * @param {string} [tip="0.00"]
 * @param {string} [total="0.00"]
 */
function showNumbers(tip = "0.00", total = "0.00") {
    displayTipPerPerson.textContent = tip;
    displayTotalPerPerson.textContent = total;
}


/**
 * Очищає всі повідомлення про помилки в елементах small.
 */
function clearErrors() {
    errors.forEach((error) => {
        error.textContent = "";
    });
}

/**
 * Очищає форму до початкового стану
 */
function clearForm() {
    showNumbers();
    clearErrors();
    bill.setCustomValidity("");
    numberOfPeople.setCustomValidity("");
    form.reset();
}


/**
 * Видаляє клас "active" з усіх кнопок чайових.
 * @param {NodeListOf&lt;HTMLButtonElement>} listButtons
 */
function removeClassActive(listButtons) {
    listButtons.forEach((button) => {
        button.classList.remove("active");
    });
}

/**
 * Очищає введення до формату десяткового числа 
 * з максимум двома знаками після крапки.
 * @param {string} value
 * @returns {string}
 */
function decimalInput(value) {
    value = value.replace(/[^\d.]+/g, "");
    const parts = value.split(".");

    if (parts.length > 2) {
        value = parts[0] + "." + parts.slice(1, 3).join("");
    }

    if (value.includes(".")) {
        const dotIndex = value.indexOf(".");
        const intPart = value.substring(0, dotIndex);
        let decimalPart = value.substring(dotIndex + 1);

        if (decimalPart.length > 2) {
            decimalPart = decimalPart.substring(0, 2);
        }

        value = intPart + "." + decimalPart;
    }

    return value;
}

/**
 * Очищає введення до цілого числа.
 * @param {string} value
 * @returns {string}
 */
function integerInput(value) {
    value = value.replace(/[^\d]+/g, "");
    return value;
}

/**
 * Отримує відсоток чайових з активної кнопки або поля вводу.
 * @returns {number}
 */
function getTipPercent() {
    const customTipPercent = parseFloat(customTip.value);

    if (isNaN(customTipPercent) || customTipPercent === 0) {
        const tip = [...tipButtons].filter((button) => button.classList.contains("active"));
        tipPercent = parseFloat(tip[0].textContent);
        return tipPercent;
    }

    return parseFloat(customTipPercent);
}


/**
 * Перевіряє, чи значення елемента більше нуля .
 * @param {HTMLInputElement} element
 * @returns {boolean|undefined}
 */
function validationNonZero(element) {
    const value = parseFloat(element.value);

    const parentElement = element.closest(".with-icon");
    const errorElement = parentElement.querySelector("small");

    if (isNaN(value) || value &lt;= 0) {
        showErrorMessage(errorElement, "Can't be zero");
        element.setCustomValidity("Can't be zero");
        return;
    }
    showErrorMessage(errorElement);
    element.setCustomValidity("");
    return true;
}


/**
 * Виводить повідомлення про помилку.
 * @param {HTMLElement} element
 * @param {string} [message=""]
 */
function showErrorMessage(element, message = "") {
    element.textContent = message;
}

/**
 * Обробка поля вводу рахунку
 */
bill.addEventListener("input", function () {
    this.value = decimalInput(this.value).substring(0, 7);
    process();
});

/**
 * Обробка поля вводу кастомного відсотка чайових
 */
customTip.addEventListener("input", function () {
    this.value = integerInput(this.value).substring(0, 3);
    process();
});

/**
 * Обробка поля вводу кількості людей
 */
numberOfPeople.addEventListener("input", function () {
    this.value = integerInput(this.value).substring(0, 3);
    process();
});

/**
 * Обробка кліку на кнопки чайових.
 */
tipButtons.forEach((button) => {
    button.addEventListener("click", () => {
        removeClassActive(tipButtons);
        button.classList.add("active");
        customTip.value = "";
        process();
    });
});

/**
 * Розраховує чайові та загальну суму на одну людину.
 * @returns {string[]} [tipPerPerson, totalPerPerson]
 */
function calculate() {
    const billNumber = parseFloat(bill.value);
    const tip = getTipPercent();
    const peopleNumber = parseInt(numberOfPeople.value);

    const totalSumWithTip = billNumber + (billNumber * tip) / 100;
    const tipPerPerson = (tip / peopleNumber).toFixed(2);
    const totalPerPerson = (totalSumWithTip / peopleNumber).toFixed(2);

    return [tipPerPerson, totalPerPerson];
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#bill">bill</a></li><li><a href="global.html#calculate">calculate</a></li><li><a href="global.html#clearErrors">clearErrors</a></li><li><a href="global.html#clearForm">clearForm</a></li><li><a href="global.html#customTip">customTip</a></li><li><a href="global.html#decimalInput">decimalInput</a></li><li><a href="global.html#displayTipPerPerson">displayTipPerPerson</a></li><li><a href="global.html#displayTotalPerPerson">displayTotalPerPerson</a></li><li><a href="global.html#errors">errors</a></li><li><a href="global.html#form">form</a></li><li><a href="global.html#getTipPercent">getTipPercent</a></li><li><a href="global.html#integerInput">integerInput</a></li><li><a href="global.html#numberOfPeople">numberOfPeople</a></li><li><a href="global.html#process">process</a></li><li><a href="global.html#removeClassActive">removeClassActive</a></li><li><a href="global.html#resetButton">resetButton</a></li><li><a href="global.html#showErrorMessage">showErrorMessage</a></li><li><a href="global.html#showNumbers">showNumbers</a></li><li><a href="global.html#tipButtons">tipButtons</a></li><li><a href="global.html#validationNonZero">validationNonZero</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Thu Jul 31 2025 15:57:49 GMT+0300 (за східноєвропейським літнім часом)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
